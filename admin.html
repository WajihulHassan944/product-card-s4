<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Game</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="style.css">
  
    <!-- cdn icon link  -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <!-- custom css file  -->
   
</head>
<body>
<div class="before">

<div class="icon icon-one">
           <i class="fas fa-user" id="loginto1"></i>
			<h4 id="nameofUser1"></h4>
			<h4 id="emailofUser1" style="text-transform: lowercase; display:none;"></h4>
       </div>
	   
	   
	   
	   
	</div>
<div class="after">

<div class="icon icon-two">
           <i class="fas fa-user" id="loginto2"></i>
			<h4 id="nameofUser2"></h4>
			<h4 id="emailofUser2" style="text-transform: lowercase; display:none;"></h4>
       </div>
	</div>
	
<input type="hidden" id="con1" value="">	
	
<script>
var logintoIcon1 = document.getElementById("loginto1");
logintoIcon1.addEventListener("click", function() {
  var urlParams = new URLSearchParams(window.location.search);
var loginSuccessful = urlParams.get('loginSuccessful') === 'true';
var userParam = urlParams.get('user'); // Get the user parameter from the URL

if (loginSuccessful && userParam === '1') {

    var url = window.location.href.replace('?loginSuccessful=true&objectId=', '');

    // Reset the color of the icon to black
    logintoIcon1.style.color = "black";

    // Show a logout alert message
    alert("You have been successfully logged out.");

    // Redirect to index.html after a short delay
    setTimeout(function() {
      window.location.href = "game.html";
    }, 1000); // Delay of 2 seconds before redirecting (adjust as needed)
  } else {
    // User is not logged in, redirect to login page
    window.location.href = "login.html?user=1";
  }
});



async function fetchUserData1() {
  const nameofUser1 = document.getElementById("nameofUser1");
  const emailofUser1 = document.getElementById("emailofUser1");
  
  try {
    var urlParams = new URLSearchParams(window.location.search);
    var objectId = urlParams.get('objectId');
    var userParam = urlParams.get('user'); // Get the user parameter from the URL
    var loginSuccessful = urlParams.get('loginSuccessful') === 'true';
if (loginSuccessful && userParam === '1') {


 try {
      const response = await fetch("https://lovely-mite-leg-warmers.cyclic.app/storeObjectId", {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
        },
        body: JSON.stringify({ objectId }),
      });

      if (!response.ok) {
       console.log("Error storing objectId in server");
      }
    } catch (error) {
      console.log("Error:", error);
    }
	fetch1();
	
}
    
  } catch (error) {
    console.error('Error:', error);
  }
}

async function fetch1(){
  const response2 = await fetch('https://lovely-mite-leg-warmers.cyclic.app/getFirstObjectId');
  
  if (response2.ok) {
    const data2 = await response2.json();
    const firstObjectId = data2.firstObjectId;
    console.log('First Object ID:', firstObjectId);
	
	    const response = await fetch('https://lovely-mite-leg-warmers.cyclic.app/users/' + firstObjectId);
    if (!response.ok) {
      throw new Error('Error fetching user data');
    }

    const data = await response.json();
    nameofUser1.innerHTML = `${data.name}`;
    emailofUser1.innerHTML = `${data.email}`;

    console.log(data);

  } else {
    console.error('Error fetching first objectId from server');
  }
}

fetchUserData1();
fetch1();
</script>
<script>
const nameofUser1 = document.getElementById("nameofUser1");

nameofUser1.addEventListener("click", async function () {
  if (this.textContent.trim() !== "") {
    try {
      const response2 = await fetch('https://lovely-mite-leg-warmers.cyclic.app/getFirstObjectId');
      if (!response2.ok) {
        throw new Error('Error fetching first objectId from server');
      }

      const data2 = await response2.json();
      const firstObjectId = data2.firstObjectId;

      // Delete the first objectId
      const deleteResponse = await fetch(`https://lovely-mite-leg-warmers.cyclic.app/deleteObjectId/${firstObjectId}`, {
        method: 'DELETE'
      });

      if (deleteResponse.ok) {
        console.log('Object ID deleted');
      } else {
        console.error('Error deleting object ID:', deleteResponse.statusText);
      }
    } catch (error) {
      console.error('Error:', error);
    }
  } else {
    // If nameofUser1 is empty, do something else or show an alert
    console.log('nameofUser1 is empty');
  }
});
</script>










	
<script>
var logintoIcon2 = document.getElementById("loginto2");
logintoIcon2.addEventListener("click", function() {
  var urlParams = new URLSearchParams(window.location.search);
 var loginSuccessful = urlParams.get('loginSuccessful') === 'true';
var userParam = urlParams.get('user'); // Get the user parameter from the URL
if (loginSuccessful && userParam === '2') {

    var url = window.location.href.replace('?loginSuccessful=true&objectId=', '');

    // Reset the color of the icon to black
    logintoIcon2.style.color = "black";

    // Show a logout alert message
    alert("You have been successfully logged out.");

    // Redirect to index.html after a short delay
    setTimeout(function() {
      window.location.href = "game.html";
    }, 1000); // Delay of 2 seconds before redirecting (adjust as needed)
  } else {
    // User is not logged in, redirect to login page
    window.location.href = "login.html?user=2";
  }
});



async function fetchUserData2() {

const nameofUser2 = document.getElementById("nameofUser2");
const emailofUser2 = document.getElementById("emailofUser2");
 
 try {
    var urlParams = new URLSearchParams(window.location.search);
    var objectId = urlParams.get('objectId');
	var loginSuccessful = urlParams.get('loginSuccessful') === 'true';
    var userParam = urlParams.get('user'); // Get the user parameter from the URL


if (loginSuccessful && userParam === '2') {
 try {
      const response = await fetch("https://lovely-mite-leg-warmers.cyclic.app/storeObjectId", {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
        },
        body: JSON.stringify({ objectId }),
      });

      if (!response.ok) {
        console.log("Error storing objectId in server");
      }
    } catch (error) {
     console.log("Error:", error);
    }
	
fetch2();
}	


  } catch (error) {
    console.error('Error:', error);
    
  }
}


async function fetch2(){
	
  const response2 = await fetch('https://lovely-mite-leg-warmers.cyclic.app/getLastObjectId');
  
  if (response2.ok) {
    const data2 = await response2.json();
    const lastObjectId = data2.lastObjectId;
    console.log('Last Object ID:', lastObjectId);
	
	
	const response = await fetch('https://lovely-mite-leg-warmers.cyclic.app/users/' + lastObjectId);
    if (!response.ok) {
      throw new Error('Error fetching user data');
    }

    const data = await response.json();
    nameofUser2.innerHTML = `${data.name}`;
    emailofUser2.innerHTML = `${data.email}`;

    console.log(data);

  } else {
    console.error('Error fetching first objectId from server');
  }
}

fetchUserData2();
fetch2();
</script>
<script>

const nameofUser2 = document.getElementById("nameofUser2");

nameofUser2.addEventListener("click", async function () {
  if (this.textContent.trim() !== "") {
    try {
      const response2 = await fetch('https://lovely-mite-leg-warmers.cyclic.app/getLastObjectId'); // Change the URL to get last object ID
      if (!response2.ok) {
        throw new Error('Error fetching last objectId from server');
      }

      const data2 = await response2.json();
      const lastObjectId = data2.lastObjectId;

      // Delete the last objectId
      const deleteResponse = await fetch(`https://lovely-mite-leg-warmers.cyclic.app/deleteObjectId/${lastObjectId}`, {
        method: 'DELETE'
      });

      if (deleteResponse.ok) {
        console.log('Object ID deleted');
      } else {
        console.error('Error deleting object ID:', deleteResponse.statusText);
      }
    } catch (error) {
      console.error('Error:', error);
    }
  } else {
    // If nameofUser2 is empty, do something else or show an alert
    console.log('nameofUser2 is empty');
  }
});

</script>


<div class="container">
	<div class="container-wrap">
	
	
		<div class="first-box common">
		
			<div class="first-box-wrap">
			<div class="input-group">
				<button data-product="HP">HP</button>
				<p>Head Punch</p>
			</div>
			<div class="input-group">
				<button data-product="BP">BP</button>
				<p>Body Punch</p>
			</div>
			<div class="input-group">
				<button data-product="TP">TP</button>
				<p>Total Punch</p>
			</div>
			<div class="input-group">
				<button  data-product="RW"> RW </button>
				<p>Round Winner</p>
			</div>
			<div class="input-group" >
				<button class="Twobtns" data-product="KO">  <div class="leaf-4 leaf1">KO</div>  <div class="leaf-4 leaf2">SP</div>  </button>
				<p>Survival Points <br> Knockout</p>
			</div>
			</div>
			
			<h1>Boxing Counter Admin</h1>
			<h2>RO-1-12</h2>
		</div>
		
		
		
		<div class="third-box">
			  <ol class="rounded-list">
				<li><a href="">HP Button push multiple times number</a></li>
				<li><a href="">BP Button push multiple times show number</a></li>
				<li><a href="">TP Button auto count both HP - BP</a></li>
				<li><a href="">RW Button can switch Red or Blue winner</a></li>
				<li><a href="">KO - SP Button switch Between KO 0r SP</a></li>
				<li><a href="">Two counter for fight two admin</a></li>
				<li><a href="">Every round Separately scores cycle each round</a></li>
			  
			  </ol>
		
		</div>
 <h2 style="position:absolute; top:0; left:19.3%; width:200px;">Admin player 1</h2>
  		
 <h2 style="position:absolute; top:23.5%; left:19.3%; width:200px;">Admin player 2</h2>
  		
	<div class="second-box common">
	
	<div class="second-box-wrap">
    <div class="input-group">
      <button data-product="HP">ST</button>
      <p>Head Punch</p>
    </div>
    <div class="input-group">
      <button data-product="BP">KI</button>
      <p>Body Punch</p>
    </div>
    <div class="input-group">
      <button data-product="TP">KN</button>
      <p>Total Punch</p>
    </div>
    <div class="input-group">
      <button data-product="RW">EL</button>
      <p>Round Winner</p>
    </div>
    <div class="input-group">
      <button  data-product="RW"> RW  </button>
      <p>Round Winner</p>
    </div>
    <div class="input-group last">
      <button class="Twobtns" data-product="KO">  <div class="leaf-4 leaf1">KO</div>  <div class="leaf-4 leaf2">SP</div>  </button>
      <p>Knockout-submission <br> Survival Points</p>
    </div>
  </div>
  
  <h1>UFC Counter Admin</h1>
  <h2>RO-1-12</h2>
</div>

		
		
		<div class="fourth-box">
		
		 <ol class="rounded-list">
			<li><a href="">ST: Strikes</a></li>
			<li><a href="">KI: Kicks</a></li>
			<li><a href="">KN: Knees</a></li>
			<li><a href="">El: Elbowes</a></li>
			<li><a href="">RW: Roundwinner</a></li>
			<li><a href="">RL; Round Loser</a></li>
			<li><a href="">KO: Knockout</a></li>
			<li><a href="">SP: Survival Points</a></li>
			
			
			  </ol>
		
		
		
		</div>
	
	
	
	
	
	
	
	</div>
	
	
	
	
	
	
	
	
</div>
 
 <div class="rounds">
	
	<div class="image-banner-div">
	<div id="namesToBeDisplayed"><p id="competitor1">Player 1</p><h5 class="roundsh5">V/S</h5><p id="competitor2">Player 2</p></div>
	</div>
	
	<div class="round-main">
	<h4 id="round-count">Round 1</h4>
	
	<div class="round-box">
	<h5>HP</h5>
	<h5 id="score-HP-1"></h5>
	<h5>HP</h5>
	<h5 id="score-HP-2"></h5></div>
	
	
	<div class="round-box">
	<h5>BP</h5>
	<h5 id="score-BP-1"></h5>
	<h5>BP</h5>
	<h5 id="score-BP-2"></h5></div>
	
	<div class="round-box">
	<h5>TP</h5>
	<h5 id="score-TP-1"></h5>
	<h5>TP</h5>
	<h5 id="score-TP-2"></h5></div>
	
	
	
	<div class="round-box">
	<h5>RW</h5>
	<h5 id="score-RW-1"></h5>
	<h5>RW</h5>
	<h5 id="score-RW-2"></h5></div>
	
	
	<div class="round-box">
	<h5>KO</h5>
	<h5 id="score-KO-1"></h5>
	<h5>KO</h5>
	<h5 id="score-KO-2"></h5></div>
	
	</div>
 
 
 </div>
 <!-- Add this script block at the end of the <body> tag -->
<script>
  // Object to store scores for each player
  const scores = {
    '1': { HP: 0, BP: 0, TP: 0, RW: 0, RL: 0, KO: 0, SP: 0 },
    '2': { HP: 0, BP: 0, TP: 0, RW: 0, RL: 0, KO: 0, SP: 0 }
  };

  // Update the scores on the page
  function updateScores(player) {
    const playerScores = scores[player];
    for (const key in playerScores) {
      const scoreElement = document.getElementById(`score-${key}-${player}`);
       if (scoreElement) {
      scoreElement.innerHTML = playerScores[key]; // Use textContent to set the score
    } else {
      console.log(`Score element not found for key ${key} and player ${player}`);
    }
    }
  }

 function handleButtonClick(player, action) {
  // Update scores based on the action
  if (action === 'HP' || action === 'BP' || action === 'TP') {
    scores[player][action]++;
	 
  } else if (action === 'RW') {
    scores[player]['RW'] += 100;
    scores['2']['RL'] += 25;
  } else if (action === 'KO') {
    scores[player]['KO'] += 500;
	console.log('KO Button clicked');
    scores['2']['SP'] += 25;
  } else if (action === 'SP') {
    scores[player]['SP'] += 25;
  }

  // Update the scores on the page
  updateScores(player);
}
// Attach event listeners to all buttons
const allButtons = document.querySelectorAll('.input-group button');
allButtons.forEach(button => {
  button.addEventListener('click', event => {
    let player;
    const commonContainer = event.target.closest('.common');
    
    if (commonContainer.classList.contains('first-box')) {
      player = '1';
    } else if (commonContainer.classList.contains('second-box')) {
      player = '2';
    }

     const action = event.target.getAttribute('data-product');
    console.log('Button clicked:', player, action); // Add this line for debugging
    
      handleButtonClick(player, action);
    });
	});
 
</script>

 <h6 style="font-size: 23px; font-weight: 600; color: #ccc; margin-bottom: 30px;">Predictions Submitted</h6>
<div id="predictionDiv" class="predictions"></div>

<style>
.predictions {
  border: 1px solid #ccc;
  padding: 15px;
  background-color: #f5f5f5;
  border-radius: 5px;
}

.predictions p {
  font-size: 16px;
  margin-bottom: 20px;
}

.predictions p:first-child {
  margin-top: 0;
}

.predictions p:last-child {
  margin-bottom: 0;
}

.predictions p strong {
  font-weight: bold;
}

.predictions p span {
  color: #007bff;
}

/* Add more styles as needed */
</style>

<script>
document.addEventListener('DOMContentLoaded', async () => {
  const predictionDiv = document.getElementById('predictionDiv');

  try {
    const response = await fetch('https://lovely-mite-leg-warmers.cyclic.app/api/scores');
    if (response.ok) {
      const scoresData = await response.json();
      
      let predictionsHTML = '';
	  
      scoresData.forEach(score => {
        const { player, round, scores } = score;
        predictionsHTML += `<p><strong>${player}'s Predictions (Round ${round}):</strong><br>`;
        for (const key in scores) {
          predictionsHTML += `<span>${key}:</span> ${scores[key]}<br>`;
        }
        predictionsHTML += `</p>`;
      });

      predictionDiv.innerHTML = predictionsHTML;
    } else {
      console.error('Failed to fetch scores');
    }
  } catch (error) {
    console.error('Error fetching scores:', error);
  }

  // Rest of your code for handling button clicks and predictions
});
</script>




<!--
<br>
<button id="readyBtn">Ready to Play</button>
<script src="https://cdn.socket.io/4.6.0/socket.io.min.js" integrity="sha384-c79GN5VsunZvi+Q/WObgk2in0CbZsHnjEqvFxC5DxHn9lTfNce2WW6h2pH6u/kF+" crossorigin="anonymous"></script>
<script>
const socket = io('https://backend-for-plans.onrender.com/');

document.getElementById('readyBtn').addEventListener('click', () => {
  socket.emit('ready');
});

socket.on('start', () => {
  alert('Game started!');
  // You can start the game UI or show a message here
});

// Handle game updates from the server
socket.on('update', (data) => {
  alert('Game state updated:', data);
  // Update the game UI based on the received data
});

// Handle player leaving the game
socket.on('playerLeft', (playerId) => {
  alert('Player left:', playerId);
  // Update the game UI or show a message
});




socket.on('disconnect', (reason) => {
  alert('WebSocket connection disconnected. Reason:', reason);
});

socket.on('error', (error) => {
  alert('WebSocket error:', error);
});
</script>
-->


 </body>
</html>
